!function(){function e(){}function t(e){var t=vipspa.routerMap[e.url];if("undefined"==typeof t){var n=vipspa.routerMap.defaults;return t=vipspa.routerMap[n],location.hash=n,!1}$.ajax({type:"GET",url:t.templateUrl,dataType:"html",success:function(e,n,o){$(vipspa.mainView).html(e),r(t.controller),a(t.styles)},error:function(e,t,n){if(0===$(vipspa.errorTemplateId).length)return!1;var r=$(vipspa.errorTemplateId).html();r=r.replace(/{{errStatus}}/,e.status),r=r.replace(/{{errContent}}/,e.responseText),$(vipspa.mainView).html(r)}})}function n(){var e=location.hash,n=vipspa.parse(e);t(n)}function r(e,t){var n,r=document.createElement("script");r.setAttribute("src",e),r.onreadystatechange=r.onload=function(){r.onreadystatechange=null,document.documentElement.removeChild(r),r=null,n||"function"==typeof t&&t(),n=!0},document.documentElement.appendChild(r)}function a(e,t){if(e){var n=document.getElementsByTagName("head")[0],r=e,a=document.createElement("link");a.href=r,a.setAttribute("rel","stylesheet"),a.setAttribute("media","all"),a.setAttribute("type","text/css"),n.appendChild(a)}}e.prototype.start=function(e){var t=this;t.routerMap=e.router,t.mainView=e.view,t.errorTemplateId=e.errorTemplateId,n(),window.onhashchange=function(){n()}};var o=[];e.prototype.getMessage=function(e){var t={};return $.each(o,function(n,r){r.id===e&&(t=r)}),t},e.prototype.setMessage=function(e){var t=JSON.parse(JSON.stringify(e));$.each(o,function(e,n){if(n.id===t.id)return n=t,!1}),o.push(t)},e.prototype.delMessage=function(e){if("undefined"==typeof e)return!1;var t=0;$.each(o,function(n,r){r.id===e&&(t=n)}),$.each(o,function(e,n){e>t&&(o[e-1]=n)})},e.prototype.clearMessage=function(e){o=[]},e.prototype.stringify=function(e,t){var n,r="";for(var a in t)r+=a+"="+encodeURIComponent(t[a])+"&";return""===r?n=e:(r=r.substring(0,r.length-1),n=e+"?"+r),n},e.prototype.parse=function(e){var t="undefined"==typeof e?location.hash:e,n={url:"",param:{}},r={},a="",o=t.indexOf("?");if(""===t)return n;if(o>-1){a=t.substring(1,o);var i=t.substring(o+1),p=i.split("&");$.each(p,function(e,t){var n,a,o=t.split("=");n=o[0],a=o[1],""!==n&&(r[n]=decodeURIComponent(a))})}else a=t.substring(1),r={};return{url:a,param:r}},window.vipspa=new e}();